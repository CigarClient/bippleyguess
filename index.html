<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bippley Guessing</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }

        audio {
            margin-top: 20px;
        }

        #result {
            margin-top: 20px;
            font-weight: bold;
        }
    </style>
</head>
<body>

<h1>Bippley Guessing</h1>
<p>Listen to a random clip and guess the song!</p>

<select id="modeSelect">
    <option value="0.2">Extreme</option>
    <option value="0.5">Hard</option>
    <option value="1">Difficult</option>
    <option value="2">Normal</option>
    <option value="60">Extreme Easy</option>
</select>

<select id="songSelect" disabled>
    <option value="" disabled selected>Please choose a song</option>
    <option value="baltimore.mp3">Baltimore Anthem</option>
    <option value="kodak.mp3">Kodakyangg</option>
    <option value="99.mp3">99' Bippleyootz</option>
    <option value="fuckalyootz.mp3">Put It on Duh Fuckalyootz</option>
    <option value="tippalyangin.mp3">Still Tippalyangin</option>
    <option value="wrongs.mp3">Wrongs</option>
</select>

<button onclick="playRandomClip()">Play Random Clip</button>
<button onclick="submitGuess()">Submit Guess</button>
<button onclick="resetGame()">Reset Game</button>

<audio id="audioPlayer" controls>
    Your browser does not support the audio element.
</audio>

<p id="result"></p>

<script>
    var audioPlayer = document.getElementById('audioPlayer');
    var resultElement = document.getElementById('result');
    var modeSelect = document.getElementById('modeSelect');
    var songSelect = document.getElementById('songSelect');
    var selectedClip = null;

    function playRandomClip() {
        songSelect.disabled = true;

        var modes = {
            "0.2": "Extreme",
            "0.5": "Hard",
            "1": "Difficult",
            "2": "Normal",
            "60": "Extreme Easy"
        };

        var modeValue = modeSelect.value;
        var modeLabel = modes[modeValue];

        var songs = [
            "baltimore.mp3",
            "kodak.mp3",
            "99.mp3",
            "fuckalyootz.mp3",
            "tippalyangin.mp3",
            "wrongs.mp3"
        ];

        selectedClip = songs[Math.floor(Math.random() * songs.length)];

        audioPlayer.src = selectedClip;

        audioPlayer.addEventListener('loadedmetadata', function() {
            var clipDuration = parseFloat(modeValue);
            var randomStartTime = Math.random() * (audioPlayer.duration - clipDuration);

            audioPlayer.currentTime = randomStartTime;
            resultElement.textContent = "You heard a " + modeLabel + " clip. Now, guess the song!";
            audioPlayer.style.display = 'block';  // Display the audio player

            // Lock the playback controls during the clip
            audioPlayer.controls = false;

            audioPlayer.play();

            audioPlayer.addEventListener('timeupdate', function() {
                if (audioPlayer.currentTime > randomStartTime + clipDuration) {
                    audioPlayer.pause();
                    audioPlayer.controls = true;  // Restore the playback controls
                    songSelect.disabled = false;
                }
            });
        });
    }

    function submitGuess() {
        var userGuess = songSelect.value;

        if (userGuess === selectedClip) {
            resultElement.textContent = "Congratulations! Your guess is correct.";
        } else {
            resultElement.textContent = "Oops! Your guess is incorrect. Try again.";
        }
    }

    function resetGame() {
        location.reload();  // Reload the entire page
    }
</script>

</body>
</html>
